
RewriteOptions inherit
IndexIgnore * # prevent directory listing
AddType image/webp .webp
Order deny,allow
Allow from *
<Files "robots.txt">
    Order Allow,Deny
    Allow from all
</Files>
# ------------------------------------------
# Rewrite so that php extentions are not shown
RewriteEngine on

# توجيه جميع الروابط غير الموجودة إلى صفحة 404
ErrorDocument 404 /404.php
 
# إعادة توجيه /index إلى الصفحة الرئيسية الأساسية
RewriteCond %{THE_REQUEST} /index
RewriteRule ^index$ / [R=301,L] 
RewriteRule ^(.*)/$ /$1 [R=301,L]

# إزالة `/` في نهاية الروابط
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)/$ /$1 [L,R=301]

# إزالة المعلمة preview=true
RewriteCond %{QUERY_STRING} (^|&)preview=true(&|$)
RewriteRule ^(.*)$ /$1? [R=301,L]

# إزالة المعلمة page=1
RewriteCond %{QUERY_STRING} (^|&)page=1(&|$)
RewriteRule ^(.*)$ /$1? [R=301,L]

# إعادة توجيه الروابط التي تحتوي على preview=true أو p= إلى الرابط الأساسي بدون المعاملات
RewriteCond %{QUERY_STRING} (^|&)(preview=true|p=[0-9]+)(&|$) [NC]
RewriteRule ^(.*)$ /? [R=301,L]

# إزالة المعاملات الأخرى مثل page=1 وتحويلها للرابط الأساسي
RewriteCond %{QUERY_STRING} (^|&)page=1(&|$) [NC]
RewriteRule ^(.*)$ /$1? [R=301,L]

# إعادة توجيه الروابط التي تحتوي على post_type=product أو preview=true أو p=
RewriteCond %{QUERY_STRING} (^|&)(post_type=product|preview=true|p=[0-9]+)(&|$) [NC]
RewriteRule ^(.*)$ /? [R=301,L]
############### Categories ########

# إعادة توجيه /index و /shop في نهاية روابط الأقسام إلى الرابط الأساسي للقسم
RewriteCond %{REQUEST_URI} ^/product-category/(.+?)/index/?$ [NC]
RewriteRule ^product-category/(.+)/index/?$ /product-category/$1 [R=301,L]

RewriteCond %{REQUEST_URI} ^/product-category/(.+?)/shop/?$ [NC]
RewriteRule ^product-category/(.+)/shop/?$ /product-category/$1 [R=301,L]

# تأكد من أن الروابط التي تحتوي على /page/1 يتم إعادة توجيهها إلى الرابط الأساسي للقسم

# Redirect /product-category/index to /categories
RewriteRule ^product-category/index/?$ /categories [R=301,L]

# Redirect /product-category/(.+)/page/1 to /product-category/$1
RewriteCond %{REQUEST_URI} ^/product-category/(.+?)/page/1/?$ [NC]
RewriteRule ^product-category/(.+)/page/1/?$ /product-category/$1 [R=301,L]

########## Products 
# إعادة توجيه /index و /shop في نهاية روابط المنتجات إلى الرابط الأساسي للمنتج
RewriteCond %{REQUEST_URI} ^/product/(.+?)/index/?$ [NC]
RewriteRule ^product/(.+)/index/?$ /product/$1 [R=301,L]

RewriteCond %{REQUEST_URI} ^/product/(.+?)/shop/?$ [NC]
RewriteRule ^product/(.+)/shop/?$ /product/$1 [R=301,L]

# تأكد من أن الروابط التي تحتوي على /page/1 يتم إعادة توجيهها إلى الرابط الأساسي للمنتج
RewriteCond %{REQUEST_URI} ^/product/(.+?)/page/1/?$ [NC]
RewriteRule ^product/(.+)/page/1/?$ /product/$1 [R=301,L]

RewriteCond %{REQUEST_URI} ^/blog/?$ [NC]
RewriteRule ^ /blog-category [L,R=301]

######################################################################

# قاعدة إعادة توجيه للصفحات الديناميكية
RewriteCond %{THE_REQUEST} /category_products\?cat=([^\s&]+) [NC]
RewriteRule ^category_products$ /product-category/%1 [R=301,L,NE]

# لمنع التوجيه إلى index ضمن product-category
RewriteCond %{REQUEST_URI} ^/product-category/index [NC]
RewriteRule ^ - [L,R=404]

# إعادة التوجيه من HTTP إلى HTTPS
RewriteCond %{HTTPS} off
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# إعادة التوجيه من non-www إلى www
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^ https://www.%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

 

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php

RewriteRule ^product/(.*)$ /product?slug=$1 [L]
RewriteRule ^product-category/(.*)$ /product-category?cat=$1 [L]
RewriteRule ^blog-categories-details/(.*)$ /blog-categories-details?cat=$1 [L,QSA]
RewriteRule ^blog/(.*)$ /blog_details?slug=$1 [L]
RewriteRule ^land/(.*)$ /land_details?slug=$1 [L]

RewriteRule ^gallary/(.*)$ /mashtly/gallary-details?slug=$1 [L]
################## Start Redirect Old Link ###############################
Redirect 301 /10-نصائح-لنباتات-منزلية-دائمة-الخضرة  /blog/10-نصائح-لنباتات-منزلية-دائمة-الخضرة 
Redirect 301 /6-نصائح-لرعاية-النباتات-الداخلية      /blog/6-نصائح-لرعاية-النباتات-الداخلية
Redirect 301 /البق-الدقيقي-مصدر-البقايا-البيضاء-على /blog/البق-الدقيقي-مصدر-البقايا-البيضاء-على
Redirect 301  /ما-هو-سوس-العنكبوت-الأحمر-التعرف-على-سو   /blog/ما-هو-سوس-العنكبوت-الأحمر-التعرف-على-سوس-العنكبوت-ومكافحته
Redirect 301 /ما-هو-سوس-العنكبوت-الأحمر-التعرف-على-سو /blog/ما-هو-سوس-العنكبوت-الأحمر-التعرف-على-سوس-العنكبوت-ومكافحته/
Redirect 301 /تسميد-النباتات-أمور-هامة-يجب-معرفتها-ق  /blog/تسميد-النباتات-أمور-هامة-يجب-معرفتها-قبل-القيام-به
Redirect 301 /ساق-البامبو-أفضل-النصائح-للعناية-به-و /blog/ساق-البامبو-أفضل-النصائح-للعناية-به-وحمايته-من-الذبول
Redirect 301 /تسميد-النباتات-أمور-هامة-يجب-معرفتها-ق /blog/تسميد-النباتات-أمور-هامة-يجب-معرفتها-قبل-القيام-به
Redirect 301 /تقليم-الاشجار-أو-تشذيب-النباتات /land/تقليم-الاشجار-أو-تشذيب-النباتات
Redirect 301 /blog-categories-details/index /blog-category
##############################
# Redirect 301 /product/شتلة-الياسمين-الهندي-او-البلوماريا  /product/ياسمين-هندي-plumeria-spp
# Redirect 301 /product/نبات-الجهنمية-وتسمى-علميا-ب-bougainvillea-أفضل-ال  /product/شجرة-الجهنمية-Bougainvillea
# Redirect 301 /product/نبات-اللانتانا-كمارا /product/لانتانا-كمارا-lantana-camara
# Redirect 301 /product/نبات-الياسمين-الأحمر-او-ما-يسمى-ب-quisqualis-indica-او-rangoon-creeper  /product/ياسمين-احمر-Quisqualis-Indica
# Redirect 301 /product/نبتة-الورد-الجوري-او-الورد-السلطاني  /product/ورد-الجوري-السلطاني-rosa-damascena
# Redirect 301 /product/نبات-ملكة-الليل  /product/ملكة-الليل-cestrum-nocturnum
#############################

Redirect 301 /مراكن-ذاتية-الري   /product-category/مراكن-ذاتية-الري

Redirect 301 /category/صيانة-الحدائق  /blog-categories-details/تنسيق-الحدائق

Redirect 301 /product-category/مراكن-نباتات/ /product-category/المراكن-و-الاحواض

Redirect 301 /مكافحة-الحشرات-والآفات  /blog/مكافحة-الحشرات-والآفات/

Redirect 301 /blog/البق-الدقيقي-مصدر-البقايا-البيضاء-على /blog/البق-الدقيقي-مصدر-البقايا-البيضاء-على-أوراق-النبات

Redirect 301 /النباتات-الخارجية    /product-category/نباتات-خارجية

Redirect 301 /تصنيفات-النباتات-الداخلية-و-الخارجية   /product-category/النباتات-الداخلية

Redirect 301 /blog-category?cat=index.php/index /blog-category
# Redirect 301 /delivery_policy /delivery-policy
Redirect 301 /password/index /password/forget
Redirect 301 /payment_policy /payment-policy
Redirect 301 /product-category/index /categories
RewriteRule ^product-category/index$ /categories [R=301,L]

# Redirect specific query string to a clean URL
RewriteCond %{QUERY_STRING} cat=index.php/index [NC]
RewriteRule ^blog-category$ /blog-category? [R=301,L]

 
# ------------------------------------------
# Enable Gzip compression
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/javascript
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE application/x-httpd-php
</IfModule>

# ------------------------------------------
# Enable Brotli compression (if supported)
<IfModule mod_brotli.c>
    AddOutputFilterByType BROTLI_COMPRESS text/plain
    AddOutputFilterByType BROTLI_COMPRESS text/html
    AddOutputFilterByType BROTLI_COMPRESS text/xml
    AddOutputFilterByType BROTLI_COMPRESS text/css
    AddOutputFilterByType BROTLI_COMPRESS text/javascript
    AddOutputFilterByType BROTLI_COMPRESS application/xml
    AddOutputFilterByType BROTLI_COMPRESS application/xhtml+xml
    AddOutputFilterByType BROTLI_COMPRESS application/rss+xml
    AddOutputFilterByType BROTLI_COMPRESS application/javascript
    AddOutputFilterByType BROTLI_COMPRESS application/x-javascript
    AddOutputFilterByType BROTLI_COMPRESS application/x-httpd-php
</IfModule>

# ------------------------------------------
# إعدادات التخزين المؤقت للمتصفح
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access plus 1 month"
    
    # Images
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    
    # CSS and JavaScript
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    
    # Fonts
    ExpiresByType application/font-woff "access plus 1 year"
    ExpiresByType application/font-woff2 "access plus 1 year"
    ExpiresByType font/ttf "access plus 1 year"
    ExpiresByType font/otf "access plus 1 year"
    
    # Other
    ExpiresByType application/pdf "access plus 1 month"
    ExpiresByType video/mp4 "access plus 1 month"
</IfModule>

# ------------------------------------------
# Enable cache control headers
<IfModule mod_headers.c>
    <FilesMatch "\.(jpg|jpeg|png|gif|webp|css|js|woff|woff2|ttf|otf|pdf|mp4)$">
        Header set Cache-Control "max-age=31536000, public"
    </FilesMatch>
</IfModule>

RewriteRule ^big_orders$ https://www.mshtly.com/big-orders [R=301,L]
RewriteRule ^join_us$ https://www.mshtly.com/join-us [R=301,L]
RewriteRule ^paymentـpolicy$ https://www.mshtly.com/payment-policy [R=301,L]
RewriteRule ^deliveryـpolicy$ https://www.mshtly.com/delivery-policy [R=301,L]

# RewriteCond %{HTTP_HOST} ^.*$
# RewriteRule ^شتلة\-الياسمين\-الهندي\-او\-البلوماريا$ "https\:\/\/www\.mshtly\.com\/product\/ياسمين\-هندي\-plumeria\-spp" [R=301,L]
# RewriteCond %{HTTP_HOST} ^.*$
# RewriteRule ^product\/شتلة\-الياسمين\-الهندي\-او\-البلوماريا$ "https\:\/\/www\.mshtly\.com\/product\/ياسمين\-هندي\-plumeria\-spp" [R=301,L]

# BEGIN cPanel-generated php ini directives, do not edit
# Manual editing of this file may result in unexpected behavior.
# To make changes to this file, use the cPanel MultiPHP INI Editor (Home >> Software >> MultiPHP INI Editor)
# For more information, read our documentation (https://go.cpanel.net/EA4ModifyINI)
<IfModule php8_module>
   php_flag display_errors Off
   php_value max_execution_time 300
   php_value max_input_time 600
   php_value max_input_vars 1000
   php_value memory_limit 512M
   php_value post_max_size 64M
   php_value session.gc_maxlifetime 1440
   php_value session.save_path "/var/cpanel/php/sessions/ea-php82"
   php_value upload_max_filesize 8M
   php_flag zlib.output_compression Off
</IfModule>
<IfModule lsapi_module>
   php_flag display_errors Off
   php_value max_execution_time 300
   php_value max_input_time 600
   php_value max_input_vars 1000
   php_value memory_limit 512M
   php_value post_max_size 64M
   php_value session.gc_maxlifetime 1440
   php_value session.save_path "/var/cpanel/php/sessions/ea-php82"
   php_value upload_max_filesize 8M
   php_flag zlib.output_compression Off
</IfModule>
# END cPanel-generated php ini directives, do not edit

# php -- BEGIN cPanel-generated handler, do not edit
# Set the “ea-php82” package as the default “PHP” programming language.
<IfModule mime_module>
  AddHandler application/x-httpd-ea-php82 .php .php8 .phtml
</IfModule>
# php -- END cPanel-generated handler, do not edit
